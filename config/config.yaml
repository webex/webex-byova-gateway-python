# Webex Contact Center BYOVA Gateway Configuration

# Gateway settings
gateway:
  host: "0.0.0.0"
  port: 50051

# Connectors configuration
connectors:
  # Local Audio Connector
  local_audio_connector:
    type: "local_audio_connector"
    class: "LocalAudioConnector"
    module: "connectors.local_audio_connector"
    config:
      audio_files:
        welcome: "welcome.wav"
        transfer: "transferring.wav"
        goodbye: "goodbye.wav"
        error: "error.wav"
        default: "default_response.wav"
      agents:
        - "Local Playback"

  # AWS Lex Connector
  aws_lex_connector:
    type: "aws_lex_connector"
    class: "AWSLexConnector"
    module: "connectors.aws_lex_connector"
    config:
      region_name: "us-east-1"

      # Initial trigger text sent when starting a conversation (default: "hello")
      # For Bedrock agents, use a simple greeting rather than a specific request
      # to avoid triggering function calls before the agent is ready
      initial_trigger_text: "hello"

      # Barge-in configuration (default: false)
      # When enabled, users can interrupt the bot's response
      barge_in_enabled: false

      # Audio logging configuration
      audio_logging:
        enabled: true
        output_dir: "logs/audio_recordings"
        filename_format: "{conversation_id}_{timestamp}_{source}.wav"
        log_all_audio: true
        max_file_size: 10485760
        sample_rate: 8000
        bit_depth: 8
        channels: 1
        encoding: "ulaw"
      agents: []

# Monitoring interface
monitoring:
  enabled: true
  host: "0.0.0.0"
  port: 8080
  metrics_enabled: true
  health_check_interval: 30

# Authentication configuration
authentication:
  enabled: true
  environment: "dev"  # Options: "dev" or "production"

  # Session configuration
  session:
    timeout_hours: 24  # Session timeout in hours
    secret_key_env: "FLASK_SECRET_KEY"  # Environment variable for session secret

  # Webex OAuth configuration
  webex_oauth:
    scopes: "openid email profile"
    state: "byova_gateway_auth"

# JWT validation configuration for gRPC requests
jwt_validation:
  # Enable/disable JWT validation (default: true for production security)
  enabled: true
  
  # Enforce validation - if false, invalid tokens are logged but allowed (default: true)
  enforce_validation: true
  
  # Datasource URL - must match the URL configured in your Webex Contact Center datasource
  # This should be the publicly accessible URL of your gateway (including port if non-standard)
  # Example: "https://your-gateway-domain.com:443"
  datasource_url: ""
  
  # Datasource schema UUID - typically this is the BYOVA schema UUID
  # This is the schema ID from https://github.com/webex/dataSourceSchemas
  # Path: Services/VoiceVirtualAgent/5397013b-7920-4ffc-807c-e8a3e0a18f43/schema.json
  # Default value is the standard BYOVA schema UUID and should not change unless
  # there is a major modification to the BYOVA schema definition
  datasource_schema_uuid: "5397013b-7920-4ffc-807c-e8a3e0a18f43"
  
  # Cache duration for public keys in minutes (default: 60)
  # Public keys are fetched from Webex identity broker and cached to improve performance
  cache_duration_minutes: 60

# Logging configuration
logging:
  gateway:
    level: "INFO"
    format: "%(asctime)s - %(name)s - %(levelname)s - %(message)s"
    file: "logs/gateway.log"
    max_size: "10MB"
    backup_count: 5

  web:
    level: "WARNING"
    format: "%(asctime)s - %(name)s - %(levelname)s - %(message)s"
    file: "logs/web.log"
    max_size: "5MB"
    backup_count: 3

# Session management
sessions:
  timeout: 600
  max_sessions: 1000
  cleanup_interval: 60
  enable_auto_cleanup: true
  max_session_duration: 3600

# Audio processing
audio:
  supported_formats:
    - "wav"
    - "mp3"
    - "flac"
    - "ogg"